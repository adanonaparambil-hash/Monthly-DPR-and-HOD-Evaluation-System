<div class="dashboard-container">
  <!-- Parallax Background Elements -->
  <div class="parallax-bg">
    <div class="parallax-layer bg-layer-1"></div>
    <div class="parallax-layer bg-layer-2"></div>
    <div class="parallax-layer bg-layer-3"></div>
    
    <!-- Floating Elements -->
    <div class="floating-elements">
      <div class="floating-shape shape-1"></div>
      <div class="floating-shape shape-2"></div>
      <div class="floating-shape shape-3"></div>
      <div class="floating-shape shape-4"></div>
      <div class="floating-shape shape-5"></div>
    </div>
    
    <!-- Animated Particles -->
    <div class="particles-bg">
      @for (particle of particles; track particle.x) {
        <div class="particle" 
             [style.left.px]="particle.x" 
             [style.top.px]="particle.y"
             [style.animation-delay.s]="particle.delay">
        </div>
      }
    </div>
  </div>

  <!-- Top Stats Cards -->
  <div class="stats-grid" #statsGrid>
    <div class="stat-card gsap-card" #statCard1>
      <div class="card-glow"></div>
      <div class="stat-header">
        <span class="stat-title">Tasks Completed</span>
        <i class="fas fa-check-circle stat-icon"></i>
      </div>
      <div class="stat-content">
        <div class="stat-number counter" [attr.data-target]="dashboardData.taskCompleted || 0">{{ dashboardData.taskCompleted || 0 }}</div>
        <div class="stat-subtitle">This month</div>
      </div>
    </div>

    <div class="stat-card gsap-card" #statCard2>
      <div class="card-glow"></div>
      <div class="stat-header">
        <span class="stat-title">Productivity Score</span>
        <i class="fas fa-chart-line stat-icon"></i>
      </div>
      <div class="stat-content">
        <div class="stat-number counter" [attr.data-target]="dashboardData.productivityScore || 0">{{ dashboardData.productivityScore || 0 }}</div>
        <div class="stat-subtitle">Out of 100</div>
        <div class="stat-change" [class.positive]="getPercentageValue(dashboardData.productivityScorePercentage) >= 0" [class.negative]="getPercentageValue(dashboardData.productivityScorePercentage) < 0">
          <i class="fas" [class.fa-arrow-up]="getPercentageValue(dashboardData.productivityScorePercentage) >= 0" [class.fa-arrow-down]="getPercentageValue(dashboardData.productivityScorePercentage) < 0"></i>
          <span>{{ Math.abs(getPercentageValue(dashboardData.productivityScorePercentage)) }}%</span>
        </div>
      </div>
    </div>

    <div class="stat-card gsap-card" #statCard3>
      <div class="card-glow"></div>
      <div class="stat-header">
        <span class="stat-title">Hours This Month</span>
        <i class="fas fa-clock stat-icon"></i>
      </div>
      <div class="stat-content">
        <div class="stat-number counter" [attr.data-target]="dashboardData.hoursThisMonth || 0">{{ dashboardData.hoursThisMonth || 0 }}</div>
        <div class="stat-subtitle">Hours logged</div>
        <div class="stat-change" [class.positive]="getPercentageValue(dashboardData.hoursThisMonthPercentage) >= 0" [class.negative]="getPercentageValue(dashboardData.hoursThisMonthPercentage) < 0">
          <i class="fas" [class.fa-arrow-up]="getPercentageValue(dashboardData.hoursThisMonthPercentage) >= 0" [class.fa-arrow-down]="getPercentageValue(dashboardData.hoursThisMonthPercentage) < 0"></i>
          <span>{{ Math.abs(getPercentageValue(dashboardData.hoursThisMonthPercentage)) }}%</span>
        </div>
      </div>
    </div>

    <div class="stat-card gsap-card" #statCard4>
      <div class="card-glow"></div>
      <div class="stat-header">
        <span class="stat-title">HOD Rating</span>
        <i class="fas fa-star stat-icon"></i>
      </div>
      <div class="stat-content">
        <div class="stat-number counter" [attr.data-target]="dashboardData.hodRating || 0">{{ dashboardData.hodRating || 0 }}</div>
        <div class="stat-subtitle">out of 100</div>
        <div class="stat-change" [class.positive]="getPercentageValue(dashboardData.hodRatingPercentage) >= 0" [class.negative]="getPercentageValue(dashboardData.hodRatingPercentage) < 0">
          <i class="fas" [class.fa-arrow-up]="getPercentageValue(dashboardData.hodRatingPercentage) >= 0" [class.fa-arrow-down]="getPercentageValue(dashboardData.hodRatingPercentage) < 0"></i>
          <span>{{ Math.abs(getPercentageValue(dashboardData.hodRatingPercentage)) }}%</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Charts Section -->
  <div class="charts-grid" #chartsGrid>
    <!-- Hours Logged Chart -->
    <div class="chart-card gsap-chart" #chartCard1>
      <div class="chart-glow"></div>
      <div class="chart-header">
        <h3>Hours Logged (Estimated vs Actual)</h3>
        <div class="chart-icon">
          <i class="fas fa-chart-bar"></i>
        </div>
      </div>
      <div class="chart-container">
        <canvas #hoursChart></canvas>
      </div>
    </div>

    <!-- Monthly Performance Trend -->
    <div class="chart-card gsap-chart" #chartCard2>
      <div class="chart-glow"></div>
      <div class="chart-header">
        <h3>Monthly Performance Trend</h3>
        <div class="chart-icon">
          <i class="fas fa-chart-line"></i>
        </div>
      </div>
      <div class="chart-container">
        <canvas #performanceChart></canvas>
      </div>
    </div>
  </div>

  <!-- Bottom Charts Section -->
  <div class="bottom-charts-grid" #bottomChartsGrid>
    <!-- Skills Assessment -->
    <div class="chart-card gsap-chart" #chartCard3>
      <div class="chart-glow"></div>
      <div class="chart-header">
        <h3>Skills Assessment</h3>
        <div class="chart-icon">
          <i class="fas fa-radar-chart"></i>
        </div>
      </div>
      <div class="chart-container">
        <canvas #skillsChart></canvas>
      </div>
    </div>

    <!-- Task Status Distribution -->
    <div class="chart-card gsap-chart task-status-chart" #chartCard4>
      <div class="chart-glow"></div>
      <div class="chart-header">
        <h3>Task Status Distribution</h3>
        <div class="chart-icon">
          <i class="fas fa-chart-pie"></i>
        </div>
      </div>
      <div class="chart-container">
        <canvas #taskStatusChart style="width: 100%; height: 100%;"></canvas>
      </div>
      <div class="legend">
        <div class="legend-item">
          <div class="legend-color completed"></div>
          <span>Completed: {{ getTaskPercentage('completed') }}% ({{ dashboardData.taskCompleted || 0 }})</span>
        </div>
        <div class="legend-item">
          <div class="legend-color in-progress"></div>
          <span>In Progress: {{ getTaskPercentage('progress') }}% ({{ dashboardData.progressTasks || 0 }})</span>
        </div>
        <div class="legend-item">
          <div class="legend-color pending"></div>
          <span>Pending: {{ getTaskPercentage('pending') }}% ({{ dashboardData.pendingTasks || 0 }})</span>
        </div>
      </div>
    </div>
  </div>
</div>
